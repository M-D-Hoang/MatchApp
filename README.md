
![MatchApp Logo](client\build\logo192.png)
# MatchApp
An online marketplace.
Created by:
* Yu Hua Yang
* Minh Duc Hoang
* Vasilii Iurev
* Brandon P. Olynyk

https://620fmp.azurewebsites.net/


# Initial Setup
To install the dependencies, run
```
npm install
```
in the project root. This will download all the required dependencies for both the client and the server.

## .env File Declaration

The first thing you should do is copy the `/server/template.env` and name that copy `.env`. Fill it with the following information:

| Key                        | Value                                                                             |
|----------------------------|-----------------------------------------------------------------------------------|
| LOCATION_API               | The API key from https://geocode.maps.co                                          |
| GOOGLE_CLIENT_ID           | The Client ID found in the credentials section of the Google Cloud OAUTH service on the Credentials page: https://console.cloud.google.com/                                                                                  |
| GOOGLE_CLIENT_SECRET       | The client secret, found in the same page as the above. **THIS IS SENSITIVE -  DO NOT SHARE**                                                                                   |
| AZURE_SAS                  | The SAS token of your Azure SAS for the storage blob.                                                                                   |
| AZURE_STORAGE_ACCOUNT_NAME |  The name of the Storage Account you'd like to use.                                                                                 |
| ATLAS_URI                  |    The URI of the MongoDB server. You can either use MongoDBAtlas, or create a MongoDB server of your own.                                                                               |
| SESSION_SECRET             | The secret key used for storing sessions. Should be a secure, autogenerated hash. |



## Seed the database

1. Open the `server/utils/seed.cjs` file.
2. Go to the bottom where the following is shown:
```
// occupyUserDB();
occupyItemDB();
// occupyCarDB();
```
3. You must run `npm run seed` in the `/server/` directory three times. After each time, you must un-comment one of the above and re-comment out the one that was already without. You must do this once per each of the above lines to seed each respective collection.

## Final Preperation
After seeding, go into the `/client/` directory and run `npm run build`. This will build a client so the server can run. After this, you are now ready to run the webserver for either development or production.

# Running Unit Tests and Linting Tools

*  To run unit tests, run `npm run test` in the `server` directory.
* To lint, run the following in either `server` or `client`:
```
node ./node_modules/eslint/bin/eslint.js --ext js,jsx,mjs,cjs --max-warnings=0
```

# Running for Development

1. Start up the express server by going into `/server/` and running `npm run start`, or `npm run dev` if you want to run it with nodemon. 
**MAKE SURE YOU SET YOUR ENVIRONMENT VARIABLES OR THE APP WON'T WORK**
2. Look for the following output. If it's there, the server is up and running correctly:
```
Successfully conected to the DB
Server listening on port 3000!
```
3. Inside the `/client/` directory, run `npm run start`. 
4. When prompted to select a different port to run, select YES. This will run the Create-React-App's development client in port 3001.

The server will now be running at port 3000, while the development client will be running at port 3001. A proxy to port 3000 is already provided so the two servers can communicate.

# Running for Deployment

This assumes you are runninng a clean copy of the repo.

To run with just the server alone:
1. Install all dependencies without development dependencies by running `npm run installDeployment` in the project's root folder.
2. Rebuild the client by doing `npm run build` in the `client` directory. This will produce a minified, packed version of the react app to be served via the server.
3. Run the server using `npm run start` in the `/server/` directory. After booting, the server will run on port 3000.

